FILEPREFIX=msvc8
MAKELOG=${FILEPREFIX}buildRelease.log
RUNLOG=${FILEPREFIX}examplelogs.tar.gz
MAKEALLLOG=${FILEPREFIX}buildDebug.log
BATCH_RESULT_DIR=${FILEPREFIX}batch_result
REPORT_DIR=${FILEPREFIX}report
REMOTEDIR="behrisch@shell.sf.net:sumo-www/"

#source $HOME/env.sh
cd $HOME/workspace/sumo
svn up &> $MAKELOG
/cygdrive/c/Programme/Microsoft\ Visual\ Studio\ 8/Common7/IDE/VCExpress.exe /rebuild Release build\\msvc8\\prj.sln /out $MAKELOG
gzip -f $MAKELOG
/cygdrive/c/Programme/Microsoft\ Visual\ Studio\ 8/Common7/IDE/VCExpress.exe /rebuild Debug build\\msvc8\\prj.sln /out $MAKEALLLOG
gzip -f $MAKEALLLOG

chmod 644 $MAKELOG.gz $MAKEALLLOG.gz
scp -q $MAKELOG.gz $MAKEALLLOG.gz behrisch@shell.sf.net:sumo-www/

if test -e bin/sumo.exe; then
  # run tests
  export PATH=/cygdrive/d/texttest:$PATH
  ln bin/dfrouter.exe bin/sumo-dfrouter
  ln bin/duarouter.exe bin/sumo-duarouter
  ln bin/guisim.exe bin/sumo-guisim
  ln bin/jtrrouter.exe bin/sumo-jtrrouter
  ln bin/netconvert.exe bin/sumo-netconvert
  ln bin/netgen.exe bin/sumo-netgen
  ln bin/od2trips.exe bin/sumo-od2trips
  ln bin/polyconvert.exe bin/sumo-polyconvert
  ln bin/sumo.exe bin/sumo
  tests/testDaily.sh $PWD/bin $BATCH_RESULT_DIR $REPORT_DIR &> /dev/null
  scp -qr $REPORT_DIR $REMOTEDIR
  rm bin/sumo-* bin/sumo
fi

